{
  "Variables": {
    "title": {
      "Position": 0,
	  "IsNull": false,
      "Description": "Title of the Picture",
      "type": "string",
      "Value": "My Title"
    },
    "imageTags": {
      "Position": 1,
	  "IsNull": false,
      "Description": "string representing a json array of strings. i.e.: [\"tag 1\", \"tag 2\"]",
      "type": "jsonArray",
      "Value": [ "FACE" ]
    },
    "instantInSeconds": {
      "Position": 2,
	  "IsNull": false,
      "Description": "Used by the Frame Task to get the Instant in seconds where to get the Picture ",
      "type": "decimal",
      "Value": 60
    },
    "uniqueName": {
      "Position": 3,
	  "IsNull": false,
      "type": "string",
      "Value": ""
    },
    "allowUniqueNameOverride": {
      "Position": 4,
	  "IsNull": false,
      "type": "boolean",
      "Value": false
    },
    "imageRetention": {
      "Position": 5,
	  "IsNull": false,
      "type": "string",
      "Value": "1d"
    },
    "ingester": {
      "Position": 6,
	  "IsNull": false,
      "type": "string",
      "Value": "Admin"
    },
    "initialFramesNumberToBeSkipped": {
      "Position": 7,
	  "IsNull": false,
      "Description": "In case of Face Recognition, number of frames to be skipped at the beginning",
      "type": "integer",
      "Value": 1500
    },
    "imageUserData": {
      "Position": 8,
	  "IsNull": false,
      "type": "jsonObject",
	  "Value": {},
      "Description": "string representing a json object. i.e: {\"data 1\": \"value 1\", \"data 2\": 32 }"
    },
    "processingStartingFrom": {
      "IsNull": true,
      "Position": 9,
      "type": "datetime",
      "Value": ""
    },
    "references": {
      "Position": 10,
	  "IsNull": false,
      "Description": "string representing a json array of ONE References. i.e.: [{\"mediaItemKey\", 123456}]",
      "type": "jsonArray",
      "Value": [ ]
    }
  },
  "label": "Best Picture of the Video",
  "type": "Workflow",
  "task": {
    "label": "${title}",
    "type": "GroupOfTasks",
    "parameters": {
      "executionType": "parallel",
	  "processingStartingFrom": "${processingStartingFrom}",
      "referencesOutput": [
        {"label": "Frame Containing Face: ${title}"},
        {"label": "Frame: ${title}"}
      ],
      "tasks": [{
        "label": "Frame Containing Face: ${title}",
        "type": "Face-Recognition",
        "onError": {"task": {
          "label": "Frame: ${title}",
          "type": "Frame",
          "onSuccess": {"task": {
			"label": "Encoding profiles (Frame): ${title}",
			"parameters": {
				"executionType": "parallel",
				"processingStartingFrom": "${processingStartingFrom}",
				"tasks": [
					{
						"label": "Encode image MMS_JPG_W240 (Frame): ${title}",
						"parameters": {
							"contentType": "image",
							"encodingPriority": "High",
							"encodingProfileLabel": "MMS_JPG_W240",
							"processingStartingFrom": "${processingStartingFrom}"
						},
						"type": "Encode"
					},
					{
						"label": "Encode image MMS_PNG_W240 (Frame): ${title}",
						"parameters": {
							"contentType": "image",
							"encodingPriority": "High",
							"encodingProfileLabel": "MMS_PNG_W240",
							"processingStartingFrom": "${processingStartingFrom}"
						},
						"type": "Encode"
					}
				]
			  },
			"type": "GroupOfTasks"
			}},
          "parameters": {
            "allowUniqueNameOverride": "${allowUniqueNameOverride}",
            "uniqueName": "${uniqueName}",
            "height": 480,
            "ingester": "${ingester}",
            "instantInSeconds": "${instantInSeconds}",
			"processingStartingFrom": "${processingStartingFrom}",
            "retention": "${imageRetention}",
            "tags": "${imageTags}",
            "title": "${title}",
			"userData": "${imageUserData}",
            "width": 640
          }
        }},
        "onSuccess": {"task": {
          "label": "Encoding profiles (FrameContainingFace): ${title}",
          "parameters": {
			"executionType": "parallel",
			"processingStartingFrom": "${processingStartingFrom}",
			"tasks": [
				{
					"label": "Encode image MMS_JPG_W240 (FrameContainingFace): ${title}",
					"parameters": {
						"contentType": "image",
						"encodingPriority": "High",
						"encodingProfileLabel": "MMS_JPG_W240",
						"processingStartingFrom": "${processingStartingFrom}"
					},
					"type": "Encode"
				},
				{
					"label": "Encode image MMS_PNG_W240 (FrameContainingFace): ${title}",
					"parameters": {
						"contentType": "image",
						"encodingPriority": "High",
						"encodingProfileLabel": "MMS_PNG_W240",
						"processingStartingFrom": "${processingStartingFrom}"
					},
					"type": "Encode"
				}
			]
          },
          "type": "GroupOfTasks"
		}},
        "parameters": {
          "allowUniqueNameOverride": "${allowUniqueNameOverride}",
          "uniqueName": "${uniqueName}",
          "CascadeName": "haarcascade_frontalface_alt_tree",
          "encodingPriority": "High",
          "ingester": "${ingester}",
          "initialFramesNumberToBeSkipped": "${initialFramesNumberToBeSkipped}",
          "OneFramePerSecond": true,
          "Output": "FrameContainingFace",
		  "processingStartingFrom": "${processingStartingFrom}",
		  "references": "${references}",
          "retention": "${imageRetention}",
          "tags": "${imageTags}",
          "title": "${title}",
		  "userData": "${imageUserData}"
        }
      }]
    }
  }
}
