{
  "Variables": {
    "Title": {
      "Position": 0,
	  "IsNull": false,
      "Description": "Title of the Picture",
      "type": "string",
      "Value": "My Title"
    },
    "ImageTags": {
      "Position": 1,
	  "IsNull": false,
      "Description": "string representing a json array of strings. i.e.: [\"tag 1\", \"tag 2\"]",
      "type": "jsonArray",
      "Value": [ "FACE" ]
    },
    "InstantInSeconds": {
      "Position": 2,
	  "IsNull": false,
      "Description": "Used by the Frame Task to get the Instant in seconds where to get the Picture ",
      "type": "decimal",
      "Value": 60
    },
    "UniqueName": {
      "Position": 3,
	  "IsNull": false,
      "type": "string",
      "Value": ""
    },
    "AllowUniqueNameOverride": {
      "Position": 4,
	  "IsNull": false,
      "type": "boolean",
      "Value": false
    },
    "ImageRetention": {
      "Position": 5,
	  "IsNull": false,
      "type": "string",
      "Value": "1d"
    },
    "ingester": {
      "Position": 6,
	  "IsNull": false,
      "type": "string",
      "Value": "Admin"
    },
    "InitialFramesNumberToBeSkipped": {
      "Position": 7,
	  "IsNull": false,
      "Description": "In case of Face Recognition, number of frames to be skipped at the beginning",
      "type": "integer",
      "Value": 1500
    },
    "ImageUserData": {
      "Position": 8,
	  "IsNull": false,
      "type": "jsonObject",
	  "Value": {},
      "Description": "string representing a json object. i.e: {\"data 1\": \"value 1\", \"data 2\": 32 }"
    },
    "processingStartingFrom": {
      "IsNull": true,
      "Position": 9,
      "type": "datetime",
      "Value": ""
    },
    "References": {
      "Position": 10,
	  "IsNull": false,
      "Description": "string representing a json array of ONE References. i.e.: [{\"mediaItemKey\", 123456}]",
      "type": "jsonArray",
      "Value": [ ]
    }
  },
  "label": "Best Picture of the Video",
  "type": "Workflow",
  "task": {
    "label": "${Title}",
    "type": "GroupOfTasks",
    "parameters": {
      "executionType": "parallel",
	  "processingStartingFrom": "${processingStartingFrom}",
      "referencesOutput": [
        {"label": "Frame Containing Face: ${Title}"},
        {"label": "Frame: ${Title}"}
      ],
      "tasks": [{
        "label": "Frame Containing Face: ${Title}",
        "type": "Face-Recognition",
        "OnError": {"task": {
          "label": "Frame: ${Title}",
          "type": "Frame",
          "OnSuccess": {"task": {
			"label": "Encoding profiles (Frame): ${Title}",
			"parameters": {
				"executionType": "parallel",
				"processingStartingFrom": "${processingStartingFrom}",
				"tasks": [
					{
						"label": "Encode image MMS_JPG_W240 (Frame): ${Title}",
						"parameters": {
							"contentType": "image",
							"encodingPriority": "High",
							"encodingProfileLabel": "MMS_JPG_W240",
							"processingStartingFrom": "${processingStartingFrom}"
						},
						"type": "Encode"
					},
					{
						"label": "Encode image MMS_PNG_W240 (Frame): ${Title}",
						"parameters": {
							"contentType": "image",
							"encodingPriority": "High",
							"encodingProfileLabel": "MMS_PNG_W240",
							"processingStartingFrom": "${processingStartingFrom}"
						},
						"type": "Encode"
					}
				]
			  },
			"type": "GroupOfTasks"
			}},
          "parameters": {
            "AllowUniqueNameOverride": "${AllowUniqueNameOverride}",
            "UniqueName": "${UniqueName}",
            "Height": 480,
            "ingester": "${ingester}",
            "InstantInSeconds": "${InstantInSeconds}",
			"processingStartingFrom": "${processingStartingFrom}",
            "retention": "${ImageRetention}",
            "tags": "${ImageTags}",
            "Title": "${Title}",
			"userData": "${ImageUserData}",
            "Width": 640
          }
        }},
        "OnSuccess": {"task": {
          "label": "Encoding profiles (FrameContainingFace): ${Title}",
          "parameters": {
			"executionType": "parallel",
			"processingStartingFrom": "${processingStartingFrom}",
			"tasks": [
				{
					"label": "Encode image MMS_JPG_W240 (FrameContainingFace): ${Title}",
					"parameters": {
						"contentType": "image",
						"encodingPriority": "High",
						"encodingProfileLabel": "MMS_JPG_W240",
						"processingStartingFrom": "${processingStartingFrom}"
					},
					"type": "Encode"
				},
				{
					"label": "Encode image MMS_PNG_W240 (FrameContainingFace): ${Title}",
					"parameters": {
						"contentType": "image",
						"encodingPriority": "High",
						"encodingProfileLabel": "MMS_PNG_W240",
						"processingStartingFrom": "${processingStartingFrom}"
					},
					"type": "Encode"
				}
			]
          },
          "type": "GroupOfTasks"
		}},
        "parameters": {
          "AllowUniqueNameOverride": "${AllowUniqueNameOverride}",
          "UniqueName": "${UniqueName}",
          "CascadeName": "haarcascade_frontalface_alt_tree",
          "encodingPriority": "High",
          "ingester": "${ingester}",
          "InitialFramesNumberToBeSkipped": "${InitialFramesNumberToBeSkipped}",
          "OneFramePerSecond": true,
          "Output": "FrameContainingFace",
		  "processingStartingFrom": "${processingStartingFrom}",
		  "References": "${References}",
          "retention": "${ImageRetention}",
          "tags": "${ImageTags}",
          "Title": "${Title}",
		  "userData": "${ImageUserData}"
        }
      }]
    }
  }
}
